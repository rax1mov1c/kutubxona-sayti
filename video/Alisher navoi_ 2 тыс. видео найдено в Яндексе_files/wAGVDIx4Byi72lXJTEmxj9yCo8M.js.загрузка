window.jQuery&&window.jQuery.fn.bem&&window.bemhtml&&(BEM.DOM.decl("market-cart",{onSetMod:{js:{inited:function(){this.badge=this.elem("badge");var e=this._getStorage(),t=this.params,a=Number(e.updated),o=t.loginHash===e.loginHash;a&&t.cartInfo.updated<a&&o?this._setBadgeValue(e.goods):this._updateStorage({goods:t.cartInfo.count,updated:t.cartInfo.updated}),this._initBus()}}},_initBus:function(){Ya.reactBus.on("marketCart:changeBadgeCount",function(e){this._updateBadge(e&&e.goodsCount)}.bind(this))},_updateBadge:function(e){var t=new Date,a=0,o=this._getStorage();o.goods&&(a=o.goods),(a+=e||1)<0||(this._updateStorage({goods:a,updated:Math.floor(t.getTime()/1e3)}),this._setBadgeValue(a),Ya.reactBus.emit("marketCart:changeBadgeCount:success"))},_setBadgeValue:function(e){Number(e)>0?(this.badge.html(e),this.delMod("badgeHidden")):this.setMod("badgeHidden",!0)},_updateStorage:function(e){var t=window.BEM.blocks["i-cookie"].get();t.yp("mcv",e.goods),t.yp("mct",e.updated),t.yp("mcl",this.params.loginHash)},_getStorage:function(){var e=window.BEM.blocks["i-cookie"].get().ypRead();return{goods:e.mcv&&Number(e.mcv.value),updated:e.mct&&e.mct.value,loginHash:e.mcl&&e.mcl.value}},_resetStorage:function(){this._getStorage().goods&&this._updateStorage({goods:0,updated:0})}}),BEM.DOM.decl("market-cart",{onSetMod:{js:{inited:function(){this._serpHeader=BEM.blocks["serp-header"],this._serpHeader.replacePlaceholder("market-cart",this),this.__base.apply(this,arguments)}}}}));